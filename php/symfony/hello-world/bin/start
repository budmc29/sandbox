#!/bin/bash
set -e

cd "$(dirname "$0")/.."

echo "ğŸš€ Starting Symfony Blog Application..."
echo ""

# Build and start all services
docker compose up --build -d

echo ""
echo "â³ Waiting for database to be ready..."
sleep 5

# Run migrations
echo "ğŸ“¦ Running database migrations..."
docker compose exec -T php php bin/console doctrine:migrations:migrate --no-interaction 2>/dev/null || \
docker compose exec -T php php bin/console doctrine:schema:create --no-interaction 2>/dev/null || true

echo ""
echo "âœ… Application started successfully!"
echo ""
echo "ğŸŒ Frontend:  http://localhost:5173"
echo "ğŸ”§ Backend:   http://localhost:8000"
echo "ğŸ“¡ API:       http://localhost:8000/api/blog-posts"
echo ""
echo "To stop: docker compose down"
echo "To view logs: docker compose logs -f"
